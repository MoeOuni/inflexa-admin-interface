import{u as Ie,j as e,D as Te,n as Fe,B as w,o as ke,p as Oe,q as ze,x as S,M as Ae,z as Pe,g as b,I as Be,E as Le,F as _e,m as A,C as Ye,a as Ee,b as He,c as Ve,H as Ue,ac as $e,X as qe}from"./index-Cpj_313k.js";import{S as Ke}from"./sales-stats-iHTP77b6.js";import{E as We,u as Je,g as Xe,a as Ge,b as Qe,c as Ze,f as Me}from"./index-BQcsQ1J8.js";import{T as De,a as es,b as C,c as ss,d as as,e as Re}from"./table-CP6PtkBs.js";import{B as ts}from"./box-BfyP_raW.js";import{R as ns,A as ds,F as rs,a as is,u as cs,O as os,C as ls}from"./order-review-skeleton-CNh9FqML.js";import{T as ms}from"./index-BFjICAYF.js";import{A as xs,a as hs}from"./arrow-down-wide-narrow-BA2zBQjS.js";import{S as y}from"./separator-CbIO-aeg.js";import"./order-query-keys-CKvnANFa.js";import"./toArray-DaCh-VYn.js";import"./shadow-smhd3i8u.js";import"./colors-CxA5wLuG.js";import"./genComponentStyleHook-BLUmqr6G.js";function js({sale:n}){const{t:s}=Ie(),d=()=>{n!=null&&n.invoicePdf?window.open(`http://localhost:5050/${n==null?void 0:n.invoicePdf}`,"_blank"):Ae.info("Invoice is not available")},i=()=>{},c=()=>{},h=async()=>{var l;if(n!=null&&n.invoicePdf){const j=`http://localhost:5050/${n==null?void 0:n.invoicePdf}`,u=await(await fetch(j)).blob(),g=URL.createObjectURL(u),o=document.createElement("a");o.href=g,o.download=(l=n==null?void 0:n.invoicePdf)==null?void 0:l.split("uploads/")[1],o.click()}else Ae.info("Invoice is not available.")};return e.jsxs(Te,{children:[e.jsx(Fe,{asChild:!0,children:e.jsxs(w,{variant:"ghost",className:"h-8 w-8 p-0",children:[e.jsx("span",{className:"sr-only",children:s("open_menu")}),e.jsx(We,{className:"h-4 w-4"})]})}),e.jsxs(ke,{className:"w-64",children:[e.jsx(Oe,{children:"Sale Actions"}),e.jsx(ze,{}),e.jsxs(S,{onClick:d,children:[e.jsx(ts,{className:"mr-2 h-4 w-4"}),e.jsx("span",{children:"View Invoice Details"})]}),e.jsxs(S,{onClick:c,children:[e.jsx(ns,{className:"mr-2 h-4 w-4"}),e.jsx("span",{children:"Issue Refund"})]}),e.jsxs(S,{onClick:i,children:[e.jsx(ds,{className:"mr-2 h-4 w-4"}),e.jsx("span",{children:"Archive Sale"})]}),e.jsxs(S,{onClick:h,children:[e.jsx(rs,{className:"mr-2 h-4 w-4"}),e.jsx("span",{children:"Export Invoice"})]})]})]})}function us({data:n,setSaleId:s}){var f,N;const{t:d}=Ie(),{currency:i}=Pe(),[c,h]=b.useState([]),[l,j]=b.useState([]),[p,u]=b.useState({}),[g,o]=b.useState({}),m=[{accessorKey:"orderNumber",header:"Reference",cell:({row:t})=>t.original.invoiceNumber||t.original.orderNumber},{accessorKey:"createdAt",header:"Date",cell:({row:t})=>A(t.original.createdAt).format("YYYY-MM-DD HH:mm")},{accessorKey:"totalAmount",header:"Amount",cell:({row:t})=>{var a;return((a=t.original.totalAmount)==null?void 0:a.toFixed(2))+" "+(i==null?void 0:i.symbol)}},{id:"actions",header:"Actions",enableHiding:!1,cell:({row:t})=>e.jsx(js,{sale:t.original})}],r=Je({data:n,columns:m,onSortingChange:h,onColumnFiltersChange:j,getCoreRowModel:Xe(),getPaginationRowModel:Ge(),getSortedRowModel:Qe(),getFilteredRowModel:Ze(),onColumnVisibilityChange:u,onRowSelectionChange:o,initialState:{pagination:{pageIndex:0,pageSize:10}},state:{sorting:c,columnFilters:l,columnVisibility:p,rowSelection:g}});return e.jsxs("div",{className:"max-w-full",children:[e.jsxs("div",{className:"flex items-center gap-2 pb-4",children:[e.jsx(Be,{placeholder:"Search by reference",value:((f=r.getColumn("orderNumber"))==null?void 0:f.getFilterValue())??"",onChange:t=>{var a;return(a=r.getColumn("orderNumber"))==null?void 0:a.setFilterValue(t.target.value)},className:"max-w-xs"}),e.jsxs(Te,{children:[e.jsx(Fe,{asChild:!0,children:e.jsxs(w,{variant:"outline",className:"ml-auto",children:[d("columns")," ",e.jsx(Le,{className:"ml-2 h-4 w-4"})]})}),e.jsx(ke,{align:"end",children:r.getAllColumns().filter(t=>t.getCanHide()).map(t=>{var a;return e.jsx(_e,{className:"capitalize",checked:t.getIsVisible(),onCheckedChange:v=>t.toggleVisibility(!!v),children:String((a=t.columnDef)==null?void 0:a.header)},t.id)})})]})]}),e.jsx("div",{className:"rounded-md border",children:e.jsxs(De,{children:[e.jsx(es,{children:r.getHeaderGroups().map(t=>e.jsx(C,{children:t.headers.map(a=>e.jsx(ss,{children:a.isPlaceholder?null:e.jsxs("div",{className:a.column.getCanSort()?"cursor-pointer select-none flex items-center":"",onClick:a.column.getToggleSortingHandler(),children:[e.jsx(ms,{title:a.column.getCanSort()?a.column.getNextSortingOrder()==="asc"?"Sort ascending":a.column.getNextSortingOrder()==="desc"?"Sort descending":"Clear sort":void 0,children:Me(a.column.columnDef.header,a.getContext())}),{asc:e.jsx(xs,{className:"h-4 w-4 ml-2"}),desc:e.jsx(hs,{className:"h-4 w-4 ml-2"})}[a.column.getIsSorted()]??null]})},a.id))},t.id))}),e.jsx(as,{children:(N=r.getRowModel().rows)!=null&&N.length?r.getRowModel().rows.map(t=>e.jsx(C,{"data-state":t.getIsSelected()&&"selected",onClick:()=>{var a;return s((a=t.original)==null?void 0:a._id)},children:t.getVisibleCells().map(a=>e.jsx(Re,{children:Me(a.column.columnDef.cell,a.getContext())},a.id))},t.id)):e.jsx(C,{children:e.jsx(Re,{colSpan:m==null?void 0:m.length,className:"h-24 text-center",children:"No results."})})})]})}),e.jsx("div",{className:"flex items-center justify-end space-x-2 py-4",children:e.jsxs("div",{className:"space-x-2",children:[e.jsx(w,{variant:"outline",size:"sm",onClick:()=>r.previousPage(),disabled:!r.getCanPreviousPage(),children:d("previous")}),e.jsx(w,{variant:"outline",size:"sm",onClick:()=>r.nextPage(),disabled:!r.getCanNextPage(),children:d("next")})]})})]})}const gs=({setSaleId:n})=>{var d;const s=is({params:{status:"delivered"}});return b.useEffect(()=>{var i,c;((c=(i=s==null?void 0:s.data)==null?void 0:i.data)==null?void 0:c.length)>0&&n(s.data.data[0]._id)},[s.status]),e.jsxs(Ye,{children:[e.jsx(Ee,{children:e.jsx(He,{children:"Sales List"})}),e.jsx(Ve,{children:e.jsx(us,{data:((d=s==null?void 0:s.data)==null?void 0:d.data)||[],setSaleId:n})})]})},ps=({saleId:n})=>{var i,c,h,l,j,p,u,g,o,m,r,f,N,t,a,v,M,R,I,T,F,k,P,Y,E,H,V,O,z,B,L,_,U,$,q,K,W,J,X,G,Q,Z,D,ee,se,ae,te,ne,de,re,ie,ce,oe,le,me,xe,he,je,ue,ge,pe,fe,Ne,be,we,ve,Se,Ce;const s=cs(n),{storeConfiguration:d}=Pe();return e.jsx(Ye,{className:"overflow-hidden","x-chunk":"dashboard-05-chunk-4",children:s.isPending?e.jsx(os,{}):e.jsxs(e.Fragment,{children:[e.jsxs(Ee,{className:"bg-muted/50",children:[e.jsxs("div",{className:"flex flex-row items-start ",children:[e.jsx("div",{className:"grid gap-0.5",children:e.jsxs(He,{className:"group flex items-center gap-2 text-lg",children:["Sale ",(c=(i=s==null?void 0:s.data)==null?void 0:i.data)==null?void 0:c.orderNumber,e.jsxs(w,{size:"icon",variant:"outline",className:"h-6 w-6 opacity-0 transition-opacity group-hover:opacity-100",children:[e.jsx(ls,{className:"h-3 w-3"}),e.jsx("span",{className:"sr-only",children:"Copy Sale ID"})]})]})}),e.jsx("div",{className:"ml-auto flex items-center gap-1"})]}),e.jsxs(Ue,{children:["Date:"," ",A((l=(h=s==null?void 0:s.data)==null?void 0:h.data)==null?void 0:l.createdAt).format("MMMM DD, YYYY")]})]}),e.jsxs(Ve,{className:"p-6 text-sm",children:[e.jsxs("div",{className:"grid gap-3",children:[e.jsx("div",{className:"font-semibold",children:"Sale Details"}),e.jsx("ul",{className:"grid gap-3",children:(u=(p=(j=s==null?void 0:s.data)==null?void 0:j.data)==null?void 0:p.products)==null?void 0:u.map(x=>{var ye;return e.jsxs("li",{className:"flex items-center justify-between",children:[e.jsxs("span",{className:"text-muted-foreground",children:[(ye=x==null?void 0:x.product)==null?void 0:ye.name," x ",e.jsx("span",{children:x.quantity})]}),e.jsxs("span",{children:[(x.price*x.quantity).toFixed(2)," ",d==null?void 0:d.currency]})]},x._id)})}),e.jsx(y,{className:"my-2"}),e.jsxs("ul",{className:"grid gap-3",children:[e.jsxs("li",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-muted-foreground",children:"Subtotal"}),e.jsxs("span",{children:[(m=(o=(g=s==null?void 0:s.data)==null?void 0:g.data)==null?void 0:o.totalAmount)==null?void 0:m.toFixed(2)," ",d==null?void 0:d.currency]})]}),e.jsxs("li",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-muted-foreground",children:"Shipping"}),e.jsxs("span",{children:[(N=(f=(r=s==null?void 0:s.data)==null?void 0:r.data)==null?void 0:f.deliveryPrice)==null?void 0:N.toFixed(2)," ",d==null?void 0:d.currency]})]}),e.jsxs("li",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-muted-foreground",children:"Tax"}),e.jsxs("span",{children:[(v=(a=(t=s==null?void 0:s.data)==null?void 0:t.data)==null?void 0:a.totalTax)==null?void 0:v.toFixed(2)," ",d==null?void 0:d.currency]})]}),e.jsxs("li",{className:"flex items-center justify-between font-semibold",children:[e.jsx("span",{className:"text-muted-foreground",children:"Total"}),e.jsxs("span",{children:[(((R=(M=s==null?void 0:s.data)==null?void 0:M.data)==null?void 0:R.totalTax)+((T=(I=s==null?void 0:s.data)==null?void 0:I.data)==null?void 0:T.deliveryPrice)+((k=(F=s==null?void 0:s.data)==null?void 0:F.data)==null?void 0:k.totalAmount)).toFixed(2)," ",d==null?void 0:d.currency]})]})]})]}),e.jsx(y,{className:"my-4"}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"grid gap-3",children:[e.jsx("div",{className:"font-semibold",children:"Shipping Information"}),e.jsxs("address",{className:"grid gap-0.5 not-italic text-muted-foreground",children:[e.jsx("span",{children:(E=(Y=(P=s==null?void 0:s.data)==null?void 0:P.data)==null?void 0:Y.customer)==null?void 0:E.name}),e.jsxs("span",{children:[(O=(V=(H=s==null?void 0:s.data)==null?void 0:H.data)==null?void 0:V.shippingAddress)==null?void 0:O.state,","," ",(L=(B=(z=s==null?void 0:s.data)==null?void 0:z.data)==null?void 0:B.shippingAddress)==null?void 0:L.city,","," ",($=(U=(_=s==null?void 0:s.data)==null?void 0:_.data)==null?void 0:U.shippingAddress)==null?void 0:$.country]}),e.jsxs("span",{children:[(W=(K=(q=s==null?void 0:s.data)==null?void 0:q.data)==null?void 0:K.shippingAddress)==null?void 0:W.street,","," ",(G=(X=(J=s==null?void 0:s.data)==null?void 0:J.data)==null?void 0:X.shippingAddress)==null?void 0:G.postalCode]})]})]}),e.jsxs("div",{className:"grid auto-rows-max gap-3",children:[e.jsx("div",{className:"font-semibold",children:"Billing Information"}),e.jsxs("div",{className:"grid gap-0.5 not-italic text-muted-foreground",children:[e.jsxs("span",{children:[(D=(Z=(Q=s==null?void 0:s.data)==null?void 0:Q.data)==null?void 0:Z.billingAddress)==null?void 0:D.state,","," ",(ae=(se=(ee=s==null?void 0:s.data)==null?void 0:ee.data)==null?void 0:se.billingAddress)==null?void 0:ae.city,","," ",(de=(ne=(te=s==null?void 0:s.data)==null?void 0:te.data)==null?void 0:ne.billingAddress)==null?void 0:de.country]}),e.jsxs("span",{children:[(ce=(ie=(re=s==null?void 0:s.data)==null?void 0:re.data)==null?void 0:ie.billingAddress)==null?void 0:ce.street,","," ",(me=(le=(oe=s==null?void 0:s.data)==null?void 0:oe.data)==null?void 0:le.billingAddress)==null?void 0:me.postalCode]})]})]})]}),e.jsx(y,{className:"my-4"}),e.jsxs("div",{className:"grid gap-3",children:[e.jsx("div",{className:"font-semibold",children:"Customer Information"}),e.jsxs("dl",{className:"grid gap-3",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("dt",{className:"text-muted-foreground",children:"Customer"}),e.jsx("dd",{children:(je=(he=(xe=s==null?void 0:s.data)==null?void 0:xe.data)==null?void 0:he.customer)==null?void 0:je.name})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("dt",{className:"text-muted-foreground",children:"Email"}),e.jsx("dd",{children:e.jsx("a",{href:"mailto:",children:((fe=(pe=(ge=(ue=s==null?void 0:s.data)==null?void 0:ue.data)==null?void 0:ge.customer)==null?void 0:pe.contactInfo)==null?void 0:fe.email)||"-"})})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("dt",{className:"text-muted-foreground",children:"Phone"}),e.jsx("dd",{children:e.jsx("a",{href:"tel:",children:((ve=(we=(be=(Ne=s==null?void 0:s.data)==null?void 0:Ne.data)==null?void 0:be.customer)==null?void 0:we.contactInfo)==null?void 0:ve.phone)||"-"})})]})]})]})]}),e.jsx($e,{className:"flex flex-row items-center border-t bg-muted/50 px-6 py-3",children:e.jsxs("div",{className:"text-xs text-muted-foreground",children:["Updated"," ",e.jsx("time",{dateTime:"2023-11-23",children:A((Ce=(Se=s==null?void 0:s.data)==null?void 0:Se.data)==null?void 0:Ce.updatedAt).format("MMMM DD, YYYY")})]})})]})})},ks=()=>{const[n,s]=qe.useState("");return e.jsxs("main",{children:[e.jsx(Ke,{}),e.jsxs("div",{className:"grid pt-4 flex-1 items-start gap-4 md:gap-4 lg:grid-cols-3 xl:grid-cols-3",children:[e.jsx("div",{className:"auto-rows-max lg:col-span-2",children:e.jsx(gs,{setSaleId:s})}),e.jsx("div",{children:e.jsx(ps,{saleId:n})})]})]})};export{ks as default};
